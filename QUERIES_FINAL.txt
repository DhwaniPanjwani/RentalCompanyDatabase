2. 

SELECT DECODE(OUTNO, NULL, 'OUTLET TOTAL',
                OUTNO) "OUTLETS",
       SUM(DECODE(TO_CHAR(STARTDATE,'MM'),07,1,0)) "JULY 22",
       SUM(DECODE(TO_CHAR(STARTDATE,'MM'),08,1,0)) "AUGUST 22",
       SUM(DECODE(TO_CHAR(STARTDATE,'MM'),09,1,0)) "SEPTEMBER 22",
       COUNT(*) "QUARTER TOTAL"
FROM OUTLET JOIN VEHICLE USING(OUTNO)
            JOIN RAGREEMENT USING(LICENSENO) 
WHERE EXTRACT(YEAR FROM STARTDATE)=2022 
      AND (EXTRACT(MONTH FROM STARTDATE)=07 OR EXTRACT(MONTH FROM STARTDATE)=08 OR EXTRACT(MONTH FROM STARTDATE)=09)
GROUP BY GROUPING SETS(OUTNO,())
ORDER BY OUTNO;

4. 

SELECT DENOMINATOR."QUARTER", DENOMINATOR.MAKE, DENOMINATOR.NO_OF_RENTALS,
TO_CHAR(((NVL(NUMERATOR.NO_OF_FAULTS,0))/ DENOMINATOR.NO_OF_RENTALS)*100, 990.99) AS "LIKELIHOOD %", 
DENSE_RANK() OVER (PARTITION BY DENOMINATOR."QUARTER" 
                   ORDER BY TO_CHAR(((NVL(NUMERATOR.NO_OF_FAULTS,0))/ DENOMINATOR.NO_OF_RENTALS)*100, 990.99) DESC) 
                   AS RANK
FROM
(
  SELECT 
        (CASE WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 1 THEN 'Q1'
              WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 2 THEN 'Q2'
              WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 3 THEN 'Q3'
              WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 4 THEN 'Q4'
              END) AS "QUARTER",  
         V.MAKE, COUNT(F.REPORTNUM) AS NO_OF_FAULTS
 FROM VEHICLE V JOIN FAULTREPORT F ON F.LICENSENO = V.LICENSENO  
               JOIN RAGREEMENT R ON R.RENTALNO = F.RENTALNO  
 WHERE EXTRACT(YEAR FROM R.STARTDATE) = 2022         
 GROUP BY V.MAKE, 
         (CASE WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 1 THEN 'Q1'
               WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 2 THEN 'Q2'
               WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 3 THEN 'Q3'
               WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 4 THEN 'Q4'
               END)
 ORDER BY QUARTER
) NUMERATOR
RIGHT OUTER JOIN
(
  SELECT 
        (CASE WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 1 THEN 'Q1'
              WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 2 THEN 'Q2'
              WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 3 THEN 'Q3'
              WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 4 THEN 'Q4'
              END) AS "QUARTER",
        V.MAKE,COUNT(R.RENTALNO) AS NO_OF_RENTALS 
  FROM VEHICLE V LEFT JOIN RAGREEMENT R ON R.LICENSENO = V.LICENSENO 
  WHERE EXTRACT(YEAR FROM R.STARTDATE) = 2022   
  GROUP BY V.MAKE, 
           (CASE WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 1 THEN 'Q1'
                 WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 2 THEN 'Q2'
                 WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 3 THEN 'Q3'
                 WHEN TO_CHAR(R.STARTDATE, 'Q') LIKE 4 THEN 'Q4'
                 END)
  ORDER BY QUARTER
) DENOMINATOR
ON NUMERATOR."QUARTER" = DENOMINATOR."QUARTER"
   AND NUMERATOR.MAKE = DENOMINATOR.MAKE
ORDER BY DENOMINATOR."QUARTER";


6. 

SELECT *
FROM
(
SELECT LEVEL AS LEV, E.empno,
 LPAD(' ', 3*(LEVEL-1)) || ' - ' || E.FNAME || ' ' || E.LNAME AS EMPLOYEE, 
 E.POSITION AS TITLE, O.STREET AS STREET_ADDRESS
FROM EMPLOYEE E LEFT JOIN OUTLET O ON O.OUTNO = E.OUTNO
START WITH E.EMPNO = 'A001'
CONNECT BY PRIOR E.EMPNO = E.SUPERNO
GROUP BY LEVEL,E.EMPNO, E.FNAME, E.LNAME, E.POSITION, O.STREET
) T1
 LEFT JOIN
(
SELECT E.empno, COUNT(F.REPORTNUM) AS NO_OF_REPORTS
FROM EMPLOYEE E LEFT JOIN FAULTREPORT F ON E.EMPNO = F.EMPNO
WHERE ROUND(SYSDATE - F.DATECHECKED)<=90
GROUP BY E.EMPNO
) T2
ON T1.EMPNO = T2.EMPNO
ORDER BY T1.LEV;


8. 
SELECT * FROM 
(
SELECT C.CLIENTNO || ' - ' || C.FNAME || ' ' || C.LNAME AS CLIENT, 
       SUM(V.DAILYRATE * (R.RETURNDATE - R.STARTDATE)) AS REVENUE, 
       RANK() OVER (ORDER BY SUM(V.DAILYRATE * (R.RETURNDATE - R.STARTDATE)) DESC) RANK
FROM CLIENT C JOIN RAGREEMENT R ON C.CLIENTNO = R.CLIENTNO
              JOIN VEHICLE V ON V.LICENSENO = R.LICENSENO
GROUP BY C.CLIENTNO, C.FNAME, C.LNAME
)
WHERE RANK=1;



10. 

SELECT "CLIENT TYPE", SUM(NO_OF_CLIENTS) AS "NO_OF_CLIENTS", SUM(NO_OF_RENTALS) AS "NO_OF_RENTALS"
FROM
(
SELECT (CASE WHEN C.WEBADDRESS LIKE '%.gov%' THEN 'GOVERNMENT AGENCY'
        WHEN C.WEBADDRESS LIKE '%.edu%' THEN 'EDUCATIONAL INSTITUTION'
        WHEN C.WEBADDRESS LIKE '%.org%' THEN 'NON-PROFIT ORGANISATION'
        WHEN C.WEBADDRESS LIKE '%.com%' THEN 'PROFIT COMPANY'
        WHEN C.WEBADDRESS IS NULL THEN 'NOT AVAILABLE'
        ELSE 'OTHER' END) AS "CLIENT TYPE", 
        COUNT(C.CLIENTNO) AS NO_OF_CLIENTS,
       (CASE WHEN ((EXTRACT(MONTH FROM R.STARTDATE)>=7) AND (EXTRACT(MONTH FROM R.STARTDATE)<=9)) THEN TO_CHAR(COUNT(R.RENTALNO),999999)
        ELSE NULL END) AS NO_OF_RENTALS
FROM CLIENT C JOIN RAGREEMENT R ON C.CLIENTNO = R.CLIENTNO
GROUP BY (CASE WHEN C.WEBADDRESS LIKE '%.gov%' THEN 'GOVERNMENT AGENCY'
        WHEN C.WEBADDRESS LIKE '%.edu%' THEN 'EDUCATIONAL INSTITUTION'
        WHEN C.WEBADDRESS LIKE '%.org%' THEN 'NON-PROFIT ORGANISATION'
        WHEN C.WEBADDRESS LIKE '%.com%' THEN 'PROFIT COMPANY'
        WHEN C.WEBADDRESS IS NULL THEN 'NOT AVAILABLE'
        ELSE 'OTHER' END),(EXTRACT(MONTH FROM R.STARTDATE))
)
GROUP BY "CLIENT TYPE";